function [Y,Xf,Af] = NNbox_14(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 27-Apr-2017 09:17:01.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx77 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_remove = [21 22 24 25 26 54 61];
x1_step1_keep = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 23 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 55 56 57 58 59 60 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77];
x1_step2_xoffset = [1.18;5;1;0;34;0;0;1100;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1.9;0;0;0;0];
x1_step2_gain = [0.134952766531714;1.18360073833014e-06;0.000395335046451868;8.69565217391304e-05;0.00666666666666667;0.0465116279069767;5.73065902578797e-06;1.63726427907091e-10;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;0.181818181818182;0.00246305418719212;0.27027027027027;3.125e-06;1.45985401459854e-05;8.69565217391304e-05;3.04539156121998e-06];
x1_step2_ymin = -1;

% Layer 1
b1 = [95.573024358661101;-29.949863988484452;194.04506716835283;-589.77867755580996;725.99650898632547;16.8464371682362;-282.67132397862383;-219.23276947068362;-665.61001601845078;7.7268785944275038;-64.724995012785797;713.53031467392634;8.3788640280213169;-93.21810816754008];
IW1_1 = [-129.16439417362787 -112.16869786917019 -265.75648353376403 43.912144505027008 -73.24873347987112 111.4471769123551 -19.138372656514314 1455.4041891256709 -50.879444446405905 -1.7421496371359486 367.68318801599281 -31.35011971819269 -97.133596154706254 -97.246221810747528 -96.784474943100932 -98.189700475858615 61.334606267314641 15.427768343080194 -97.070462352700289 5.873360654245392 -96.749068199751463 138.13099125082792 -97.203909531183172 -39.035039843593957 -209.56290304208426 -23.666393819821895 353.32271807667513 -7.2764717899284221 -8.7516168650461594 60.948494133609962 -4.9115678359619803 108.65824339715387 142.90831158197656 -686.8757028094401 -30.25562108523858 46.99479853221694 15.938768035005106 22.022973150863297 -70.204509776238055 -25.857712678018771 17.796684804711429 -9.5225310019315383 5.3957885168790192 -593.65249920178655 -15.451535050068935 14.348261216919365 13.155056934007391 -96.942717977775729 32.835014715020918 -50.362532114002903 42.570680519577046 87.14860634494336 -223.0323615916615 -96.842018395230269 -38.13217658091552 5.2079474226909843 -97.163550119253912 11.128474159921462 -16.468021182516082 29.555165146406175 1.2006270906869352 19.203614956636237 -6.1955709232018492 -102.57213811571273 8.0125131482883507 10.797584837750774 1372.5847254541907 242.51164784869871 97.688122490110757 -1244.9641416352699;59.572548497650722 -33.156036071833213 7.9853341727842206 0.063860084587840316 -24.394490189909213 -19.634767737160072 -45.025673109398774 50.566954553217691 -0.84768585632254967 0.3941723723718854 148.69245328019952 2.5740221366414135 29.610372602698423 28.103576957523565 -151.49075573394316 -7.7576505718717144 -4.343770598102771 -9.5270418687271015 25.719197191990141 -10.874490444154571 30.702888499426489 35.914469783488627 -152.75627056919012 6.1597652661532516 14.352223087072597 17.280211329301601 -7.2866626514852477 -6.985845580889567 -4.6943535635511342 -0.34043469522210623 -5.9489766744119326 -17.46836281139716 2.1366822821128792 -4.0943606260187906 -3.1967047672827311 -2.1301247504827261 -2.8730753397865629 2.0534932417661023 5.6233648618563592 -29.615833393639921 -0.35857156673942581 -3.7908043851574944 -9.3786922911913386 -4.6679803478015742 2.2399064297582831 -1.2962731623682719 0.68347906331553698 31.063994531701965 0.89788490851418645 -6.1260721232030528 -2.3014841881068691 6.6409262131469351 0.25578287258985088 31.500594408191791 4.5485551396656536 6.4071378991253534 30.626481788392635 -0.0029700237064769208 -0.31988349029943697 -2.9239279790751875 -7.3547275524411226 -4.3855686282575856 0.34509186955803983 -1.8249081219455801 12.28766171826064 -1.3428975811718722 -410.03085439165847 -35.755511251173495 -36.808370620612465 412.89541432071667;-0.67153987953617311 2.261935333581532 -2.4169731928769176 -1.1477524516153099 3.6675617074580402 -2.0735146180618327 -10.294911169635059 69.347360477774117 1.092926907719225 -0.38199712586957457 -205.41223641059625 259.91974284642924 -191.43240941982421 257.42201762889255 -111.23166180186705 265.08900251436023 265.82497816308643 264.88299126969054 -197.87869163530547 264.92442078496543 -192.89045606749011 270.15177612728718 276.52363644935025 -0.53004611320865958 -22.721973041881235 18.815993756323635 -0.057555544371260092 -1.5988204002472113 0.22533422687299476 94.535228892213468 0.222915184586507 23.65518321896543 -95.486153553231318 -0.39925387017554714 0.83130291786736266 -0.37271367420870738 1.0085747506613481 0.045422041872907104 -0.7370049590416784 8.7108404581084145 -1.1973834490560051 0.16096993800839512 -0.42549350813459252 3.6031535699505883 0.10074948632480935 -1.7027170825621885 -0.66872972653780627 -192.99021646478039 -0.73612267867454939 0.16445156491559398 1.1381389457601307 -0.94399707927880827 -0.12755055283244393 -194.52819584257782 -0.049771061231634633 1.3462402592092211 -208.97361012600814 -1.5839037047143236 -0.2622866143634871 -0.018799608176674171 1.0870431625482833 0.45635271166692581 -0.47753243456262645 -0.41412123820617019 -2.5970057841405567 1.3012891434343221 4.5412320747085637 6.4655794747992843 2.9577034509329581 -1.4274818561955893;-66.728951121038449 -16.682158656746676 -59.971710985944092 38.128134057058425 -48.156217456600508 -63.762347258153603 -6.2669967541307798 183.7637279802824 5.6349627952457491 10.379373765724749 -503.14529559991269 47.105131433171728 589.99490984798604 589.31696935006721 -4806.4401442916806 -3.0213739887276745 -4.8829364683894756 -10.461477035324133 590.29602705686193 -20.589755062263293 590.86352795151174 41.416367102516652 625.7671844733328 -15.15281159520193 -6.6347778300986668 -10.402152778810487 -13.150281448711361 3.5580369916380867 10.803372501326367 -3.5605485217819943 -0.56760196630881987 -20.348253178956554 15.722703614926672 -34.677155066367305 7.0213106906741185 3.9109072973006196 3.7193729684007169 6.4653681317368878 10.456929950438242 21.04297061757217 -33.913713521249896 5.2441362610254787 19.953431747660318 32.995137937658818 -7.9607661528515967 -3.1882514577647312 0.7670861846391579 590.51138201928529 -18.091873780149523 1.3925296711299011 -11.351551790590454 56.306992895806928 11.520933989508737 591.12824924864583 5.8881729532297129 6.1562954816748414 591.05001598005583 -27.974912070188608 -10.241538355822003 40.484032747670092 38.689259113068431 10.473286155597243 28.160782539007652 -13.504078839173204 97.261577614396202 7.4209448880048825 -1189.7590652078386 -267.35410454107313 23.850950318508435 1240.8816983739987;0.9922065896263067 -1.5714341488016876 -0.46675295127498162 0.10323880836817886 -0.23633152118956202 0.29687832472770731 -0.23348598159801814 -29.426477315278312 -0.44156473912038596 -0.85597292758617782 5328.0096421406306 -0.26382511526277891 -732.01015661107965 -241.35263287339239 -694.75498516890934 0.48460412550033516 -0.31051999366159883 -0.38312768511077211 -732.20789827465399 0.06630320183569044 -726.40256355414147 13.181429284848827 -0.83898813351481039 -0.15550336549352364 -0.13253195077573526 -0.10030269239215732 0.035773835471828677 -0.11128669477327574 0.13544503039920833 -0.087340645106072673 0.082492287880976872 0.12653239929057988 -0.26660865490379493 -0.054681115846779586 0.075944453618842347 -0.047593895284604129 0.029436824592728728 -0.041435153599587743 -0.019475054303395856 -0.023936591534129237 0.20966598212712559 -0.12870966784198071 0.16310555257931472 -0.15304275563900333 0.049363134495454535 -0.33757699906382366 0.0099890669893444306 -726.88376277732448 0.044284326174848426 0.1525045121727136 -0.058742150340216528 -0.061765160658518198 0.19777189672444273 -17.032189374205011 -0.030290653275253591 -0.0029887922397179856 -729.65986242343774 0.090464919428073498 -0.089969291432912421 -0.16503968053958706 0.058149216405626661 -0.0002600404811022583 -0.023279628427221671 -0.11087284150464691 -0.39326547578813215 -0.11384504253176152 50.597415682272832 10.586152454139352 2.4326762520773615 -49.63476036112435;64.405891627833597 -29.605121168124573 11.224348349893685 12.530384146385256 -3.3366528868497571 -14.589685273937118 9.3944171150399249 -58.994750005912444 0.063172072779953736 3.3727229187570229 4.0090221523679874 50.888818717923158 -16.905401440493566 -17.314548181174814 -17.135190090473394 8.9001104164904596 17.117717118164457 18.391693489128045 -17.103522694826072 13.840963941050033 -16.908080181975858 -1.4751875545630642 -16.597081811065049 3.6213148326139359 -55.859750853968393 2.9466028540155644 -2.6118620919425872 -6.9866941860216745 -0.49175195658521648 5.7115422684779258 -8.5796039740100518 63.962953784968306 8.8873157605912709 -3.8634801095138878 14.001615605869691 2.8638169090502474 10.938874637387176 18.252666178564908 -4.5938055840684049 -36.306847717133401 -12.39519810342677 -9.9090098825846873 -1.0890768015211361 7.2364871708997542 -5.5946006389864049 24.004303867419985 5.3113969713412192 -17.237804810619728 -3.3599116722611968 -36.216272402116132 -4.2760457423172147 -34.480100566688819 12.938656070233971 -16.838260715074526 6.8904600175054789 -9.9916420794057519 -17.209075870644625 24.664836744891709 -9.0206103365781125 -15.013959212034651 -4.668912696972443 -5.4567511566218663 2.3421521436703703 -4.3152497790496254 -6.3960247848113898 28.524883627685259 328.06517959044061 141.17954403427373 65.80229676036727 -358.54630183716404;171.33049975345676 -122.45452589070557 206.08602992025624 22.129655243753849 50.862247633164806 -9.6393693221759182 17.149545351437865 -4701.4169514614432 60.152329722446616 -38.591805431834878 272.339514557695 97.376139609403083 266.31270644377361 627.16759977725849 305.97186058213202 24.182815010615553 18.78851865544317 13.295668871156023 461.92511168296386 35.806087494354827 282.6821631297808 66.303784317145514 79.647293042725792 40.331653652559346 -21.13710460818114 -5.2130886556310561 -1.2649041491176001 65.649923941090748 -15.626965422711319 -19.076704841696813 11.437610071832742 -27.897619442660293 25.568769342809876 -21.118521901166808 -24.367318265493005 40.080451032989608 -18.71035944705314 -10.394515566472906 -26.932406494197853 -23.879216635430868 30.15647128174917 14.330825226617991 21.144805496980915 -7.4749577006256152 -7.5374416972275275 -40.18638106552045 15.693801440169214 282.58076538774964 -19.679938454564791 -25.510156867464293 -41.728107614381152 -30.699203650355994 -15.078843361448797 294.46980643009323 19.200138181634859 23.121523698789659 308.4428221722896 -20.476166895924599 -42.680578554498815 38.745216161408962 14.503939772594602 18.432884746740051 29.998921283447142 11.014507522711023 40.154352458034602 -115.3859636392267 2679.3690115924319 312.35269286703993 -49.736247268461597 -2173.4890877240714;-427.26723027953972 -466.48415421078118 276.62792201952232 16.467590175785091 29.781945975750336 178.62922760552095 57.560626973883643 2426.8455641223841 12.484049310558555 -51.257020519493416 -5905.9841346735584 243.36518894792766 219.0878391281272 219.03569260309308 219.16729936668273 -129.38000142519547 66.104347410550602 44.689277135408574 218.84758937930238 48.558528282614986 218.84996594999947 -96.345300863677338 219.17756901565136 441.20892731709455 27.683336537466992 -17.804368404149951 -84.05315497075425 2042.2243979802215 403.64396526023626 53.827084529955968 4.0870498412034575 -5.1928725391353954 -67.565864043846332 -21.862766636961926 -2047.3319163724977 -57.392618526336555 103.50045944551536 -7.8078050747968035 -3.4128057713297828 -875.35984437419029 37.083784614336267 15.341369581476894 -10.03567594534319 51.213147587059424 31.830215883247128 -51.270763945718812 58.465494780263235 219.08035905572476 -34.126995952924212 35.24726946746501 -135.38674793406952 515.05715543010979 7.6940171544797185 219.05755695164913 -72.531287512376977 32.041969296838083 218.86646693615282 -117.71600296221918 -21.125064822545848 -48.97192465535359 4.3268775942600897 -32.956315337741017 -29.137570743208308 -97.3849252088783 -314.65811929571987 -92.946546797751225 2982.7513745242659 653.38644046260413 291.17953729490102 -2281.3931869840203;37.359851741196074 9.3884851673270937 -29.812802115555076 -6.0799134083239732 3.8897559447316965 -7.4531196218215943 -23.387090737900976 106.55427511589353 -1.1389708457626355 -0.70129065879495078 -63.796685123567663 1.9137899421039091 666.81310587760652 668.43174266093934 658.50494028482728 -2.0415232407204185 0.5667664185338821 -0.49757205459170128 -6230.0655729430264 -0.77205604754322499 666.07265320255851 -6.2070237840592082 664.56398750996414 -0.71963442262133714 -1.4226777882675392 0.51289934737497966 -1.3190383270018886 -2.9685863205685878 -0.4081602602816039 0.49378942098962786 -0.83423802359734212 2.1920623763276361 1.6711405905775614 0.51482046427006645 0.27934673428549606 -0.97758573149308747 0.045483262492489684 1.2428788978204279 -2.3611746170876784 -3.7565563668361293 1.5696843924201671 0.54330287152270695 -0.81991374777587767 -2.5511914262052358 0.0066801630588807503 -0.66977094162734918 -1.4779318324488291 665.67429109207478 -1.0522811115623045 1.6752248461534198 -1.2278216923513869 1.1091371791344005 1.3961987937012972 666.4814084151958 0.34251227153810548 -0.44775002315105367 666.01027407325398 -1.0516927807687038 -0.29125444218497432 -0.3440561488675648 237.10449033474606 -0.29395936887350788 0.4251844937071988 2.2718048404248998 0.61134427999835483 2.134448263314547 -47.858451434285783 -12.126346526026079 -2.9251619450258084 57.828402541476123;-2848.3849606543417 1647.4965526784154 -2357.9342728955312 -508.29815948337477 112.35113054228208 -1607.8329450746521 -723.37415638575249 992.48270166383782 -513.10008359502501 31.465653359606094 -16.002556128380185 1424.6812533556476 -8.5491499974448626 -8.1971979906009587 -8.4207638620764484 446.15223552535008 656.37830540243874 -588.68453882373296 -9.9243650613288246 -93.164718677642639 -8.5544955547032302 -2307.7231927145258 -8.0561934823363153 306.96504184819844 951.31535368478455 -427.22695421966671 636.21258846341232 1205.6637627528121 419.77768922295826 -1043.1110258813121 -1033.6601760426654 -742.80720135471756 922.95423379596753 -911.06313861757769 441.29021178867481 -2276.6949204418247 -1401.0965888899082 196.13455161414291 303.85329062946397 437.32133305251159 1510.5290614680187 757.3454366034739 107.59995249106819 352.68600871529247 578.53065902629623 -375.98846908044845 180.8892246896396 -8.3340179233530307 -54.698900679058227 -1183.0054726211181 12.263637657823347 434.96552770174088 357.63764359766242 -8.4610991473975066 2443.5817052886664 -133.65228029874342 -8.0340294155169527 285.27179372451991 -188.1563010128616 201.58309608066523 -1065.4052018166826 159.20886065821924 925.65930577002632 -1080.2026181672877 1350.0118162721201 1822.4283297749716 2096.0415865815794 2449.2345896036172 -1239.4045585222877 1552.5668645979886;-2.8175794515473838 -31.839070056392206 15.831383803869697 13.374997364531307 -1.8415036924885584 -0.74869613016375247 -10.872720585729859 108.68174907905843 0.2539344708731307 0.39068019029041179 -252.80203641463677 0.41463518679212619 66.169027653530406 72.613632063198864 -88.547720473844336 5.8111974613111776 3.767311562704057 -1.1526523217756983 69.688075583468176 2.5807430413020844 65.999700584563641 82.020310021621341 -479.99267175781461 -1.5135929090456663 -7.1042847080184224 -7.0975835103146405 6.7297478520328937 -0.67046194921583502 4.1420895038731782 -0.54832155863616006 4.5268114064907703 7.9298139346780063 0.73479230022422426 -2.9901639463100658 -4.4853341467284213 2.2918578706417465 -4.1927175997805106 -3.4475340303380309 -0.95716391389779742 26.907641070632053 -1.7166351847799766 -0.82052525381633268 1.9222045408674484 -4.5532489060379984 0.058502484334755078 -2.9266608444724702 -2.3273520738377238 65.763181947086494 -1.8505091680415853 -3.8545529779228049 6.1023589342031643 -1.3766374834167165 1.6926273433102803 143.87252229306324 -2.4657305735599895 -2.9220143223962967 67.292978751469548 -3.5736752701425085 2.8881371258579485 3.3790759279995104 -3.4971906416753837 4.1214115365087904 1.600313186556511 -0.86552351538521066 3.5664110807556013 -3.5861740566858797 -23.828193250149301 -0.010590496254848869 -9.8963205510580341 44.461121033365245;-307.53691173207187 323.11995048477513 -448.70186260770049 89.373151945791321 -70.854602439442189 -43.025571736143235 -315.80790797375317 6431.2416166762814 1179.766218481202 28.583280606164024 -1382.9122188914112 -790.65556679019096 -712.37338082734311 -712.68404895303399 -712.518572404201 49.946336691903909 1384.409029097772 44.421643958834387 -712.47951782875191 91.10769034445029 -712.45711829785273 -454.98776773241241 -712.60689044163564 -3799.0959242879367 -420.12317639700467 -1.2121328659253927 -1392.4549029288144 -113.28910902507263 74.767948502408544 -830.1809535596683 -15.102338083359202 435.09678057855166 -578.84104895004145 -11.571156810587729 -500.26904583107529 35.570361375494187 -28.147958037646546 -14.341140533076887 24.211813958731749 13059.843499218505 -34.892943134944844 23.695530647255328 -25.627308959174822 -79.187255154277679 -28.145575181835795 -1372.2584280730975 -38.183640189617535 -712.37302030903902 -15.096528641636805 33.978938279277344 100.64296588594375 -604.10576461800463 -14.466401874607596 -712.55562369711879 1.3900515769757211 -17.674316988457772 -712.48188789160326 6.8462007929214108 -19.753620379683031 -60.224013674484773 77.722776693761105 -5.8809880173165157 -35.484091511139617 -16.161141987269097 -136.26762159808266 91.316889931554982 -152.8283062323672 2.2599935292631863 181.81281256112769 -35.47620931846869;-3.3195609109708646 -15.362094784658765 -7.8339857983923853 -34.589595220691791 -16.524314609759806 23.908294731830168 -48.39147585563861 -66.217057187159583 2.1583618568459535 -6.665015709458614 47.701955044225258 13.415193242794469 -7.1195945131581437 -7.0293796418025112 55.172083858824436 12.202221946444011 -16.002264034743575 -29.062498724623573 13.73842694481945 -32.110713020070492 -7.1884690322923763 18.872159592089794 66.28781261919373 -4.3106523821882119 -23.880460800989372 50.148219554198107 -5.8034703080371601 -14.568488171123077 -10.127326391195982 22.010666461697742 -8.2480213370576365 -11.558444779996575 19.413763166660495 -17.689998511309884 -15.623008893882016 -22.64028953554341 12.149658351296194 10.159802579405792 -7.9360670739855603 -2.5963858885462003 35.211368759041044 9.1328408280732454 -8.9252751930959349 17.05286725044926 29.731325845949385 -18.923674411223057 -39.654522126396728 -6.8372870007740829 1.0971848985681421 3.3381673280709649 5.5039310686267946 1.1548484303928079 28.289914650994394 -6.9703324745448247 10.729276509672896 37.876840837744773 27.168909482062755 -18.791750067828335 -3.3903317912658615 8.2983743287804099 1.8951970401664793 21.485633633408945 -3.976354120574217 3.0021736576111784 -43.094176551169099 -82.266371622298351 -155.54052258785401 -64.346124612238754 4.2133677285658813 158.17183401810541;-1.52167456144171 -8.4863566130417443 0.13085365196697007 -0.13895471495431966 -0.81483121136043124 -0.13552276427144994 -0.95222069716396907 7.3234747654370835 0.14410342681512403 -0.17460323170376979 -760.86874988242732 0.47562331578865902 91.673759343390216 91.67094957206659 -117.68714511316809 0.67033867949605619 0.35241325673849688 0.42787947623124856 91.332597058912228 0.42574203337014749 91.840135666372078 57.350349835292796 91.16502255519805 -0.020386744035447393 -0.29474802939086014 -0.062381582823092502 0.16915914780764271 -0.17039806991368733 -0.0234142604844087 -0.065116121639447161 0.0085159032512928251 0.24270251586893515 -0.021223612643486899 -0.016607705265552969 0.20353634271393814 -0.044789609094012639 0.075389240183108594 -0.016376834010623828 0.14327649559971267 0.060418689195479304 -0.22957054594775533 -0.11876568732617292 0.0084927531047842425 0.26122944167882678 -0.034088410743638178 0.058462952295910975 0.12193720071150199 91.505467913504162 -0.026699039933385404 -0.21406158279617332 0.030191021135546323 0.00076014992713632767 0.014216209775414837 91.847508625159918 0.113882661603406 0.29744920999635283 91.505146227351844 -0.12581604339418395 -0.092904245452201231 0.01055309100140947 0.24891786772645047 0.02692672425313794 -0.14032456704017332 -0.13701374829598739 0.82868935321426362 0.67004602997236318 -19.876236666459441 -4.8296845236658044 -1.6004122968765633 22.456679110680675];

% Layer 2
b2 = -0.67429083433472836;
LW2_1 = [-0.00028517433128033825 -0.0046811231731614207 0.024531379417512184 0.011328970040490464 -0.24710480354657102 0.010083882674801307 -0.0084292027190931117 -0.0081473888924673832 -0.008959898418482732 0.0020291067044170457 0.0012951759745343456 0.002117184529255813 -0.0059382440927060569 -0.10443770965590567];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 2.6298291248145e-09;
y1_step1_xoffset = 162;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    temp = removeconstantrows_apply(X{1,ts},x1_step1_keep,x1_step1_remove);
    Xp1 = mapminmax_apply(temp,x1_step2_gain,x1_step2_xoffset,x1_step2_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings_keep,settings_remove)
if isempty(settings_remove)
    y = x;
else
    y = x(settings_keep,:);
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
